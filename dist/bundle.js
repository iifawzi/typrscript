!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);class r{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function s(e){var t;let n=!0;return e.required&&(n=n&&0!==(null===(t=e.value)||void 0===t?void 0:t.toString().trim().length)),null!=e.maxLength&&"string"==typeof e.value&&(n=n&&e.value.length>=e.maxLength),null!=e.minLength&&"string"==typeof e.value&&(n=n&&e.value.length<=e.minLength),null!=e.min&&"number"==typeof e.value&&(n=n&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(n=n&&e.value<=e.max),n}function i(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var o;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(o||(o={}));class l{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class a extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}addProject(e,t,n){const r=new l(Math.random().toString(),e,t,n,o.Active);this.projects.push(r),this.updateListeners()}static getInstance(){return this.instance||(this.instance=new a),this.instance}moveProject(e,t){const n=this.projects.find(t=>t.id===e);n&&n.status!==t&&(n.status=t),this.updateListeners()}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const c=a.getInstance();var u=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class d extends r{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;c.addProject(e,n,r),this.clearInputs()}}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=this.peopleInputElement.value,r={value:t,required:!0},i={value:+n,required:!0,min:1,max:5};return s({value:e,required:!0})&&s(r)&&s(i)?[e,t,+n]:void alert("Invalid input, please try again")}}u([i],d.prototype,"submitHandler",null);var p=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class h extends r{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":this.project.people+" persons"}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("p").textContent=this.project.description,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("h2").textContent=this.project.title}}p([i],h.prototype,"dragStartHandler",null),p([i],h.prototype,"dragEndHandler",null);var f=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class m extends r{constructor(e){super("project-list","app",!1,e+"-projects"),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){if(e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]){e.preventDefault();this.element.querySelector("ul").classList.add("droppable")}}dropHandler(e){const t=e.dataTransfer.getData("text/plain");c.moveProject(t,"finished"==this.type?o.Finished:o.Active)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),c.addListener(e=>{const t=e.filter(e=>"active"===this.type?e.status===o.Active:e.status===o.Finished);console.log(this),this.assignedProjects=t,this.renderProjects()})}renderContent(){const e=this.type+"-project-list";this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.getElementById(this.type+"-project-list").innerHTML="";for(const e of this.assignedProjects)new h(this.element.querySelector("ul").id,e)}}f([i],m.prototype,"dragOverHandler",null),f([i],m.prototype,"dropHandler",null),f([i],m.prototype,"dragLeaveHandler",null),new d,new m("active"),new m("finished")}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYmFzZS1jb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvdmFsaWRhdGlvbi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZGVjb3JhdG9ycy9hdXRvYmluZC1kZWNvcmF0b3IudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZGVscy9wcm9qZWN0LnRzIiwid2VicGFjazovLy8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvcHJvamVjdC1pdGVtLnRzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvYXBwLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiQ29tcG9uZW50IiwidGVtcGxhdGVJZCIsImhvc3RFbGVtZW50SWQiLCJpbnNlcnRBdFN0YXJ0IiwibmV3RWxlbWVudElkIiwidGhpcyIsInRlbXBsYXRlRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJob3N0RWxlbWVudCIsImltcG9ydGVkTm9kZSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiZWxlbWVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiaWQiLCJhdHRhY2giLCJpbnNlcnRBdEJlZ2lubmluZyIsImluc2VydEFkamFjZW50RWxlbWVudCIsInZhbGlkYXRlIiwidmFsaWRhdGFibGVJbnB1dCIsImlzVmFsaWQiLCJyZXF1aXJlZCIsInRvU3RyaW5nIiwidHJpbSIsImxlbmd0aCIsIm1heExlbmd0aCIsIm1pbkxlbmd0aCIsIm1pbiIsIm1heCIsImF1dG9iaW5kIiwiXyIsIl8yIiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwiY29uZmlndXJhYmxlIiwicHJvamVjdFN0YXR1cyIsIlByb2plY3QiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwibGlzdGVuZXJzIiwibGlzdG5lckZuIiwicHVzaCIsInN1cGVyIiwicHJvamVjdHMiLCJudW1PZlBlb3BsZSIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwiQWN0aXZlIiwidXBkYXRlTGlzdGVuZXJzIiwiaW5zdGFuY2UiLCJwcm9qZWN0SWQiLCJuZXdTdGF0dXMiLCJwcm9qZWN0IiwiZmluZCIsInByaiIsImxpc3RlbmVyRm4iLCJzbGljZSIsInByb2plY3RTdGF0ZSIsImdldEluc3RhbmNlIiwidGl0bGVJbnB1dEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJjb25maWd1cmUiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcmlucHV0IiwiZ2F0aGVyVXNlcklucHV0IiwiQXJyYXkiLCJpc0FycmF5IiwiZGVzYyIsImFkZFByb2plY3QiLCJjbGVhcklucHV0cyIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdWJtaXRIYW5kbGVyIiwiZW50ZXJlZFRpdGxlIiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZW50ZXJlZFBlb3BsZSIsImRlc2NyaXB0aW9uVmFsaWRhdGFibGUiLCJwZW9wbGVWYWxpZGF0YWJsZSIsImFsZXJ0IiwiaG9zdElkIiwicmVuZGVyQ29udGVudCIsImRhdGFUcmFuc2ZlciIsInNldERhdGEiLCJlZmZlY3RBbGxvd2VkIiwiY29uc29sZSIsImxvZyIsImRyYWdTdGFydEhhbmRsZXIiLCJkcmFnRW5kSGFuZGxlciIsInRleHRDb250ZW50IiwicGVyc29ucyIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwidHlwZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJwcmpJZCIsImdldERhdGEiLCJtb3ZlUHJvamVjdCIsIkZpbmlzaGVkIiwicmVtb3ZlIiwiZHJhZ092ZXJIYW5kbGVyIiwiZHJhZ0xlYXZlSGFuZGxlciIsImRyb3BIYW5kbGVyIiwiYWRkTGlzdGVuZXIiLCJyZWxldmVudFByb2plY3RzIiwiZmlsdGVyIiwicmVuZGVyUHJvamVjdHMiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSIsImlubmVySFRNTCIsInByakl0ZW0iXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFvQnFCLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIsR0FBVyxFQUFQRSxHQUE4QixpQkFBVkYsR0FBc0JBLEdBQVNBLEVBQU1HLFdBQVksT0FBT0gsRUFDaEYsSUFBSUksRUFBS1gsT0FBT1ksT0FBTyxNQUd2QixHQUZBMUIsRUFBb0JrQixFQUFFTyxHQUN0QlgsT0FBT0MsZUFBZVUsRUFBSSxVQUFXLENBQUVULFlBQVksRUFBTUssTUFBT0EsSUFDdEQsRUFBUEUsR0FBNEIsaUJBQVRGLEVBQW1CLElBQUksSUFBSU0sS0FBT04sRUFBT3JCLEVBQW9CVSxFQUFFZSxFQUFJRSxFQUFLLFNBQVNBLEdBQU8sT0FBT04sRUFBTU0sSUFBUUMsS0FBSyxLQUFNRCxJQUM5SSxPQUFPRixHQUlSekIsRUFBb0I2QixFQUFJLFNBQVMxQixHQUNoQyxJQUFJUyxFQUFTVCxHQUFVQSxFQUFPcUIsV0FDN0IsV0FBd0IsT0FBT3JCLEVBQWdCLFNBQy9DLFdBQThCLE9BQU9BLEdBRXRDLE9BREFILEVBQW9CVSxFQUFFRSxFQUFRLElBQUtBLEdBQzVCQSxHQUlSWixFQUFvQmEsRUFBSSxTQUFTaUIsRUFBUUMsR0FBWSxPQUFPakIsT0FBT2tCLFVBQVVDLGVBQWUxQixLQUFLdUIsRUFBUUMsSUFHekcvQixFQUFvQmtDLEVBQUksR0FJakJsQyxFQUFvQkEsRUFBb0JtQyxFQUFJLEcsc0NDbEY5QyxNQUFlQyxFQU1sQixZQUFZQyxFQUFtQkMsRUFBc0JDLEVBQXVCQyxHQUN4RUMsS0FBS0MsZ0JBQXVDQyxTQUFTQyxlQUFlUCxHQUNwRUksS0FBS0ksWUFBaUJGLFNBQVNDLGVBQWVOLEdBRTlDLE1BQU1RLEVBQWVILFNBQVNJLFdBQVdOLEtBQUtDLGdCQUFnQk0sU0FBUSxHQUN0RVAsS0FBS1EsUUFBYUgsRUFBYUksa0JBQzNCVixJQUNBQyxLQUFLUSxRQUFRRSxHQUFLWCxHQUV0QkMsS0FBS1csT0FBT2IsR0FHUixPQUFPYyxHQUNYWixLQUFLSSxZQUFZUyxzQkFBc0JELEVBQW9CLGFBQWUsWUFBYVosS0FBS1EsVUNWN0YsU0FBU00sRUFBU0MsRyxNQUNyQixJQUFJQyxHQUFrQixFQWdCdEIsT0FmSUQsRUFBaUJFLFdBQ2pCRCxFQUFVQSxHQUFnRSxLQUEvQixRQUF0QixFQUFBRCxFQUFpQm5DLGFBQUssZUFBRXNDLFdBQVdDLE9BQU9DLFNBRWpDLE1BQTlCTCxFQUFpQk0sV0FBdUQsaUJBQTNCTixFQUFpQm5DLFFBQzlEb0MsRUFBVUEsR0FBV0QsRUFBaUJuQyxNQUFNd0MsUUFBVUwsRUFBaUJNLFdBRXpDLE1BQTlCTixFQUFpQk8sV0FBdUQsaUJBQTNCUCxFQUFpQm5DLFFBQzlEb0MsRUFBVUEsR0FBV0QsRUFBaUJuQyxNQUFNd0MsUUFBVUwsRUFBaUJPLFdBRS9DLE1BQXhCUCxFQUFpQlEsS0FBaUQsaUJBQTNCUixFQUFpQm5DLFFBQ3hEb0MsRUFBVUEsR0FBV0QsRUFBaUJuQyxPQUFTbUMsRUFBaUJRLEtBRXhDLE1BQXhCUixFQUFpQlMsS0FBaUQsaUJBQTNCVCxFQUFpQm5DLFFBQ3hEb0MsRUFBVUEsR0FBV0QsRUFBaUJuQyxPQUFTbUMsRUFBaUJTLEtBRTdEUixFQzFCSixTQUFTUyxFQUFTQyxFQUFRQyxFQUFXQyxHQUN4QyxNQUFNQyxFQUFpQkQsRUFBV2hELE1BUXRDLE1BUDhDLENBQ3RDa0QsY0FBYyxFQUNkLE1BRUksT0FEZ0JELEVBQWUxQyxLQUFLYSxRQ0xoRCxJQUFZK0IsR0FBWixTQUFZQSxHQUFlLHVCQUFRLDJCQUFuQyxDQUFZQSxNQUFhLEtBRWxCLE1BQU1DLEVBQ1QsWUFBbUJ0QixFQUFrQnVCLEVBQXFCQyxFQUE0QkMsRUFBdUJDLEdBQTFGLEtBQUExQixLQUFrQixLQUFBdUIsUUFBcUIsS0FBQUMsY0FBNEIsS0FBQUMsU0FBdUIsS0FBQUMsVUNRMUcsTUFBTSxVQVBiLG9CQUNjLEtBQUFDLFVBQTBCLEdBQ3BDLFlBQVlDLEdBQ1p0QyxLQUFLcUMsVUFBVUUsS0FBS0QsS0FPcEIsY0FDSUUsUUFISSxLQUFBQyxTQUFzQixHQUt2QixXQUFXUixFQUFlQyxFQUFvQlEsR0FDakQsTUFBTUMsRUFBYSxJQUFJWCxFQUFRWSxLQUFLQyxTQUFTM0IsV0FBWWUsRUFBTUMsRUFBWVEsRUFBWVgsRUFBY2UsUUFDckc5QyxLQUFLeUMsU0FBU0YsS0FBS0ksR0FDbkIzQyxLQUFLK0Msa0JBR1QscUJBQ0ksT0FBSS9DLEtBQUtnRCxXQUdUaEQsS0FBS2dELFNBQVcsSUFBSSxHQUZUaEQsS0FBS2dELFNBTWIsWUFBWUMsRUFBbUJDLEdBQ3BDLE1BQU1DLEVBQVluRCxLQUFLeUMsU0FBU1csS0FBS0MsR0FBTUEsRUFBSTNDLEtBQU91QyxHQUNuREUsR0FBV0EsRUFBUWYsU0FBV2MsSUFDL0JDLEVBQVFmLE9BQVNjLEdBRW5CbEQsS0FBSytDLGtCQUdDLGtCQUNKLElBQUssTUFBTU8sS0FBY3RELEtBQUtxQyxVQUMxQmlCLEVBQVd0RCxLQUFLeUMsU0FBU2MsVUFLOUIsTUFBTUMsRUFBZSxFQUFhQyxjLDBVQ3pDbEMsTUFBTSxVQUFxQjlELEVBSzlCLGNBQ0k2QyxNQUFNLGdCQUFpQixPQUFPLEVBQUssY0FDbkN4QyxLQUFLMEQsa0JBQXNDMUQsS0FBS1EsUUFBUW1ELGNBQWMsVUFDdEUzRCxLQUFLNEQsd0JBQTRDNUQsS0FBS1EsUUFBUW1ELGNBQWMsZ0JBQzVFM0QsS0FBSzZELG1CQUF1QzdELEtBQUtRLFFBQVFtRCxjQUFjLFdBQ3ZFM0QsS0FBSzhELFlBR0QsY0FDSjlELEtBQUswRCxrQkFBa0I5RSxNQUFRLEdBQy9Cb0IsS0FBSzRELHdCQUF3QmhGLE1BQVEsR0FDckNvQixLQUFLNkQsbUJBQW1CakYsTUFBUSxHQUk1QixjQUFjbUYsR0FDbEJBLEVBQU1DLGlCQUNOLE1BQU1DLEVBQVlqRSxLQUFLa0Usa0JBQ3ZCLEdBQUlDLE1BQU1DLFFBQVFILEdBQVcsQ0FDekIsTUFBT2hDLEVBQU1vQyxFQUFLbEMsR0FBVThCLEVBQzVCVCxFQUFhYyxXQUFXckMsRUFBTW9DLEVBQUtsQyxHQUNuQ25DLEtBQUt1RSxlQUtiLFlBQ0l2RSxLQUFLUSxRQUFRZ0UsaUJBQWlCLFNBQVV4RSxLQUFLeUUsZUFHakQsaUJBRVEsa0JBQ0osTUFBTUMsRUFBZTFFLEtBQUswRCxrQkFBa0I5RSxNQUN0QytGLEVBQXFCM0UsS0FBSzRELHdCQUF3QmhGLE1BQ2xEZ0csRUFBZ0I1RSxLQUFLNkQsbUJBQW1CakYsTUFLeENpRyxFQUFzQyxDQUN4Q2pHLE1BQU8rRixFQUNQMUQsVUFBVSxHQUVSNkQsRUFBaUMsQ0FDbkNsRyxPQUFRZ0csRUFDUjNELFVBQVUsRUFDVk0sSUFBSyxFQUNMQyxJQUFLLEdBRVQsT0FDS1YsRUFmaUMsQ0FDbENsQyxNQUFPOEYsRUFDUHpELFVBQVUsS0FjVEgsRUFBUytELElBQ1QvRCxFQUFTZ0UsR0FLSCxDQUFDSixFQUFjQyxHQUFvQkMsUUFIMUNHLE1BQU0sb0NBeENkLEdBREN0RCxHLDRXQ2xCRSxNQUFNLFVBQW9COUIsRUFXN0IsWUFBWXFGLEVBQWdCN0IsR0FDekJYLE1BQU0saUJBQWlCd0MsR0FBUSxFQUFNN0IsRUFBUXpDLElBQzdDVixLQUFLbUQsUUFBVUEsRUFFZm5ELEtBQUs4RCxZQUNMOUQsS0FBS2lGLGdCQWJSLGNBQ0ksT0FBNEIsSUFBeEJqRixLQUFLbUQsUUFBUWhCLE9BQ04sV0FFR25DLEtBQUttRCxRQUFRaEIsT0FBaEIsV0FZZixpQkFBaUI0QixHQUNiQSxFQUFNbUIsYUFBY0MsUUFBUSxhQUFjbkYsS0FBS21ELFFBQVF6QyxJQUN2RHFELEVBQU1tQixhQUFjRSxjQUFnQixPQUd4QyxlQUFlMUQsR0FDWDJELFFBQVFDLElBQUksV0FHaEIsWUFDSXRGLEtBQUtRLFFBQVFnRSxpQkFBaUIsWUFBYXhFLEtBQUt1RixrQkFDaER2RixLQUFLUSxRQUFRZ0UsaUJBQWlCLFVBQVd4RSxLQUFLd0YsZ0JBR2xELGdCQUNJeEYsS0FBS1EsUUFBUW1ELGNBQWMsS0FBTThCLFlBQWN6RixLQUFLbUQsUUFBUWpCLFlBQzVEbEMsS0FBS1EsUUFBUW1ELGNBQWMsTUFBTzhCLFlBQWN6RixLQUFLMEYsUUFBVSxZQUMvRDFGLEtBQUtRLFFBQVFtRCxjQUFjLE1BQU84QixZQUFjekYsS0FBS21ELFFBQVFsQixPQWpCakUsR0FEQ1IsRyxxQ0FNRCxHQURDQSxHLDZXQ3RCRSxNQUFNLFVBQW9COUIsRUFFN0IsWUFBb0JnRyxHQUNoQm5ELE1BQU0sZUFBZ0IsT0FBTyxFQUFXbUQsRUFBSCxhQURyQixLQUFBQSxPQUVoQjNGLEtBQUs0RixpQkFBbUIsR0FFeEI1RixLQUFLOEQsWUFDTDlELEtBQUtpRixnQkFJVCxnQkFBZ0JsQixHQUNaLEdBQUlBLEVBQU1tQixjQUFnRCxlQUFoQ25CLEVBQU1tQixhQUFhVyxNQUFNLEdBQW9CLENBQ25FOUIsRUFBTUMsaUJBQ1NoRSxLQUFLUSxRQUFRbUQsY0FBYyxNQUNuQ21DLFVBQVVDLElBQUksY0FLN0IsWUFBWWhDLEdBQ1IsTUFBTWlDLEVBQVFqQyxFQUFNbUIsYUFBY2UsUUFBUSxjQUMxQ3pDLEVBQWEwQyxZQUFZRixFQUFtQixZQUFiaEcsS0FBSzJGLEtBQXFCNUQsRUFBY29FLFNBQVdwRSxFQUFjZSxRQUlwRyxpQkFBaUJwQixHQUNFMUIsS0FBS1EsUUFBUW1ELGNBQWMsTUFDbkNtQyxVQUFVTSxPQUFPLGFBRzVCLFlBQ0lwRyxLQUFLUSxRQUFRZ0UsaUJBQWlCLFdBQVl4RSxLQUFLcUcsaUJBQy9DckcsS0FBS1EsUUFBUWdFLGlCQUFpQixZQUFheEUsS0FBS3NHLGtCQUNoRHRHLEtBQUtRLFFBQVFnRSxpQkFBaUIsT0FBUXhFLEtBQUt1RyxhQUMzQy9DLEVBQWFnRCxZQUFhL0QsSUFDdEIsTUFBTWdFLEVBQW1CaEUsRUFBU2lFLE9BQU9yRCxHQUNuQixXQUFkckQsS0FBSzJGLEtBQ0N0QyxFQUFJakIsU0FBV0wsRUFBY2UsT0FFaENPLEVBQUlqQixTQUFXTCxFQUFjb0UsVUFHeENkLFFBQVFDLElBQUl0RixNQUNaQSxLQUFLNEYsaUJBQW1CYSxFQUN4QnpHLEtBQUsyRyxtQkFJYixnQkFDSSxNQUFNQyxFQUFZNUcsS0FBSzJGLEtBQVIsZ0JBQ2YzRixLQUFLUSxRQUFRbUQsY0FBYyxNQUFPakQsR0FBS2tHLEVBQ3ZDNUcsS0FBS1EsUUFBUW1ELGNBQWMsTUFBTzhCLFlBQWN6RixLQUFLMkYsS0FBS2tCLGNBQWUsWUFHckUsaUJBQzZCM0csU0FBU0MsZUFBa0JILEtBQUsyRixLQUFSLGlCQUNsRG1CLFVBQVksR0FDbkIsSUFBSyxNQUFNQyxLQUFXL0csS0FBSzRGLGlCQUMzQixJQUFJLEVBQVk1RixLQUFLUSxRQUFRbUQsY0FBYyxNQUFPakQsR0FBR3FHLElBaER6RCxHQURDdEYsRyxvQ0FVRCxHQURDQSxHLGdDQU9ELEdBRENBLEcscUNDN0JMLElBQUksRUFDSixJQUFJLEVBQVksVUFDaEIsSUFBSSxFQUFZIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcbiAgICB0ZW1wbGF0ZUVsZW1lbnQ6IEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gICAgaG9zdEVsZW1lbnQ6IFQ7XG4gICAgZWxlbWVudDogVTsgIFxuXG5cbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZUlkOiBzdHJpbmcsaG9zdEVsZW1lbnRJZDogc3RyaW5nLGluc2VydEF0U3RhcnQ6IGJvb2xlYW4sbmV3RWxlbWVudElkPzogc3RyaW5nKXtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQgPSA8SFRNTFRlbXBsYXRlRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0ZW1wbGF0ZUlkKSE7XG4gICAgICAgIHRoaXMuaG9zdEVsZW1lbnQgPSA8VD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChob3N0RWxlbWVudElkKSE7XG5cbiAgICAgICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSh0aGlzLnRlbXBsYXRlRWxlbWVudC5jb250ZW50LHRydWUpO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSA8VT5pbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgICAgIGlmIChuZXdFbGVtZW50SWQpe1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gbmV3RWxlbWVudElkXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hdHRhY2goaW5zZXJ0QXRTdGFydCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhdHRhY2goaW5zZXJ0QXRCZWdpbm5pbmc6IGJvb2xlYW4pe1xuICAgICAgICB0aGlzLmhvc3RFbGVtZW50Lmluc2VydEFkamFjZW50RWxlbWVudChpbnNlcnRBdEJlZ2lubmluZyA/ICdhZnRlcmJlZ2luJyA6ICdiZWZvcmVlbmQnLCB0aGlzLmVsZW1lbnQpO1xuICAgIH1cblxuICAgIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xuICAgIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcbn1cbiIsImV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGFibGUge1xuICAgIHZhbHVlPzpzdHJpbmcgfCBudW1iZXI7XG4gICAgcmVxdWlyZWQ/OmJvb2xlYW47XG4gICAgbWluTGVuZ3RoPzogbnVtYmVyO1xuICAgIG1heExlbmd0aD86IG51bWJlcjtcbiAgICBtaW4/OiBudW1iZXI7XG4gICAgbWF4PzogbnVtYmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUodmFsaWRhdGFibGVJbnB1dDogVmFsaWRhdGFibGUpOiBib29sZWFue1xuICAgIGxldCBpc1ZhbGlkOmJvb2xlYW4gPSB0cnVlO1xuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0LnJlcXVpcmVkKXtcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZT8udG9TdHJpbmcoKS50cmltKCkubGVuZ3RoICE9PSAwO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpe1xuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA+PSB2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aDtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdzdHJpbmcnKXtcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS5sZW5ndGggPD0gdmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGg7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0Lm1pbiAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnbnVtYmVyJyl7XG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPj0gdmFsaWRhdGFibGVJbnB1dC5taW47XG4gICAgfVxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0Lm1heCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnbnVtYmVyJyl7XG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPD0gdmFsaWRhdGFibGVJbnB1dC5tYXg7XG4gICAgfVxuICAgIHJldHVybiBpc1ZhbGlkO1xufVxuIiwiZXhwb3J0IGZ1bmN0aW9uIGF1dG9iaW5kKF86IGFueSwgXzI6c3RyaW5nLCBkZXNjcmlwdG9yOlByb3BlcnR5RGVzY3JpcHRvcil7XG4gICAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgIGNvbnN0IGFkakRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICBnZXQoKXtcbiAgICAgICAgICAgIGNvbnN0IGJvdW5kRm4gPSBvcmlnaW5hbE1ldGhvZC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIGJvdW5kRm47XG4gICAgICAgIH1cbiAgICB9O1xucmV0dXJuIGFkakRlc2NyaXB0b3I7XG59XG4iLCJleHBvcnQgZW51bSBwcm9qZWN0U3RhdHVzIHtBY3RpdmUsIEZpbmlzaGVkfTtcblxuZXhwb3J0IGNsYXNzIFByb2plY3Qge1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBpZDogc3RyaW5nLHB1YmxpYyB0aXRsZTogc3RyaW5nLHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nICxwdWJsaWMgcGVvcGxlOiBudW1iZXIsIHB1YmxpYyBzdGF0dXM6IHByb2plY3RTdGF0dXMpe1xuICAgIH1cbn1cblxuXG4iLCJpbXBvcnQge1Byb2plY3QsIHByb2plY3RTdGF0dXN9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0JztcblxudHlwZSBMaXN0ZW5lcjxUPiA9IChpdGVtczpUW10pPT4gdm9pZDtcblxuY2xhc3Mgc3RhdGU8VD4ge1xuICAgIHByb3RlY3RlZCBsaXN0ZW5lcnM6TGlzdGVuZXI8VD5bXSA9IFtdO1xuICAgIGFkZExpc3RlbmVyKGxpc3RuZXJGbjogTGlzdGVuZXI8VD4pe1xuICAgIHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdG5lckZuKTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBzdGF0ZTxQcm9qZWN0PiB7XG4gICAgcHJpdmF0ZSBwcm9qZWN0czogUHJvamVjdFtdID0gW107XG4gICAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFByb2plY3RTdGF0ZTtcbiAgICBwcml2YXRlIGNvbnN0cnVjdG9yKCl7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgfVxuICAgIHB1YmxpYyBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsbnVtT2ZQZW9wbGU6bnVtYmVyKXtcbiAgICAgICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKSwgdGl0bGUsZGVzY3JpcHRpb24sbnVtT2ZQZW9wbGUscHJvamVjdFN0YXR1cy5BY3RpdmUpXG4gICAgICAgIHRoaXMucHJvamVjdHMucHVzaChuZXdQcm9qZWN0KTtcbiAgICAgICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcbiAgICB9O1xuXG4gICAgc3RhdGljIGdldEluc3RhbmNlKCl7XG4gICAgICAgIGlmICh0aGlzLmluc3RhbmNlKXtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xuICAgIH1cblxuICAgIHB1YmxpYyBtb3ZlUHJvamVjdChwcm9qZWN0SWQ6IHN0cmluZywgbmV3U3RhdHVzOiBwcm9qZWN0U3RhdHVzKXtcbiAgICAgIGNvbnN0IHByb2plY3QgPSAgIHRoaXMucHJvamVjdHMuZmluZChwcmo9PiBwcmouaWQgPT09IHByb2plY3RJZCk7XG4gICAgICBpZihwcm9qZWN0ICYmIHByb2plY3Quc3RhdHVzICE9PSBuZXdTdGF0dXMpe1xuICAgICAgICBwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1cztcbiAgICAgIH1cbiAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVMaXN0ZW5lcnMoKXtcbiAgICAgICAgZm9yIChjb25zdCBsaXN0ZW5lckZuIG9mIHRoaXMubGlzdGVuZXJzKXtcbiAgICAgICAgICAgIGxpc3RlbmVyRm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcbiAgICAgICAgfVxuICAgIH1cblxufVxuZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZS5nZXRJbnN0YW5jZSgpO1xuIiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCdcbmltcG9ydCB7IFZhbGlkYXRhYmxlLCB2YWxpZGF0ZSB9IGZyb20gJy4uL3V0aWwvdmFsaWRhdGlvbidcbmltcG9ydCB7IGF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZC1kZWNvcmF0b3InXG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tICcuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlJ1xuICAgIC8vIFByb2plY3RJbnB1dCBDbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PntcbiAgICB0aXRsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgICBkZXNjcmlwdGlvbklucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgICBwZW9wbGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSwndXNlci1pbnB1dCcpO1xuICAgICAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50ID0gPEhUTUxJbnB1dEVsZW1lbnQ+dGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGl0bGVcIik7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSA8SFRNTElucHV0RWxlbWVudD50aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZXNjcmlwdGlvblwiKTtcbiAgICAgICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQgPSA8SFRNTElucHV0RWxlbWVudD50aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNwZW9wbGVcIik7XG4gICAgICAgIHRoaXMuY29uZmlndXJlKCk7XG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgY2xlYXJJbnB1dHMoKXtcbiAgICAgICAgdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWUgPSBcIlwiO1xuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZSA9IFwiXCI7XG4gICAgfVxuXG4gICAgQGF1dG9iaW5kXG4gICAgcHJpdmF0ZSBzdWJtaXRIYW5kbGVyKGV2ZW50OiBFdmVudCl7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHVzZXJpbnB1dCA9IHRoaXMuZ2F0aGVyVXNlcklucHV0KCk7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHVzZXJpbnB1dCkpe1xuICAgICAgICAgICAgY29uc3QgW3RpdGxlLGRlc2MscGVvcGxlXSA9IHVzZXJpbnB1dDtcbiAgICAgICAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLGRlc2MscGVvcGxlKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJJbnB1dHMoKTtcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uZmlndXJlKCl7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnN1Ym1pdEhhbmRsZXIpO1xuICAgIH1cblxuICAgIHJlbmRlckNvbnRlbnQoKXt9XG5cbiAgICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOiBbc3RyaW5nLHN0cmluZyxudW1iZXJdIHwgdm9pZHtcbiAgICAgICAgY29uc3QgZW50ZXJlZFRpdGxlID0gdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZTtcbiAgICAgICAgY29uc3QgZW50ZXJlZERlc2NyaXB0aW9uID0gdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZTtcbiAgICAgICAgY29uc3QgZW50ZXJlZFBlb3BsZSA9IHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgICAgICBjb25zdCB0aXRsZVZhbGlkYXRhYmxlOiBWYWxpZGF0YWJsZSA9IHtcbiAgICAgICAgICAgIHZhbHVlOiBlbnRlcmVkVGl0bGUsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb25WYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XG4gICAgICAgICAgICB2YWx1ZTogZW50ZXJlZERlc2NyaXB0aW9uLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHBlb3BsZVZhbGlkYXRhYmxlOiBWYWxpZGF0YWJsZSA9IHtcbiAgICAgICAgICAgIHZhbHVlOiArZW50ZXJlZFBlb3BsZSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgbWluOiAxLFxuICAgICAgICAgICAgbWF4OiA1LFxuICAgICAgICB9O1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICAhdmFsaWRhdGUodGl0bGVWYWxpZGF0YWJsZSkgfHxcbiAgICAgICAgICAgICF2YWxpZGF0ZShkZXNjcmlwdGlvblZhbGlkYXRhYmxlKSB8fFxuICAgICAgICAgICAgIXZhbGlkYXRlKHBlb3BsZVZhbGlkYXRhYmxlKSBcbiAgICAgICAgKXtcbiAgICAgICAgICAgIGFsZXJ0KFwiSW52YWxpZCBpbnB1dCwgcGxlYXNlIHRyeSBhZ2FpblwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtlbnRlcmVkVGl0bGUsIGVudGVyZWREZXNjcmlwdGlvbiwrZW50ZXJlZFBlb3BsZV07XG4gICAgICAgIH1cbiAgICB9XG59IiwiaW1wb3J0IHtEcmFnYWJsZX0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCc7XG5pbXBvcnQge1Byb2plY3R9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0JztcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vYmFzZS1jb21wb25lbnQnXG5pbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gJy4uL2RlY29yYXRvcnMvYXV0b2JpbmQtZGVjb3JhdG9yJ1xuLy8gUHJvamVjdCBJdGVtIENsYXNzOiBcblxuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsSFRNTExJRWxlbWVudD4gaW1wbGVtZW50cyBEcmFnYWJsZSB7XG4gICAgcHJpdmF0ZSBwcm9qZWN0OiBQcm9qZWN0OyBcblxuICAgIGdldCBwZXJzb25zKCl7XG4gICAgICAgIGlmICh0aGlzLnByb2plY3QucGVvcGxlID09PSAxKXtcbiAgICAgICAgICAgIHJldHVybiAnMSBwZXJzb24nO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gYCR7dGhpcy5wcm9qZWN0LnBlb3BsZX0gcGVyc29uc2BcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0cnVjdG9yKGhvc3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KXtcbiAgICAgICBzdXBlcignc2luZ2xlLXByb2plY3QnLGhvc3RJZCwgZmFsc2UscHJvamVjdC5pZCk7XG4gICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdDtcblxuICAgICAgIHRoaXMuY29uZmlndXJlKCk7XG4gICAgICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XG4gICAgfVxuICAgIEBhdXRvYmluZFxuICAgIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCl7XG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuc2V0RGF0YSgndGV4dC9wbGFpbicsIHRoaXMucHJvamVjdC5pZCk7XG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJztcbiAgICB9XG4gICAgQGF1dG9iaW5kXG4gICAgZHJhZ0VuZEhhbmRsZXIoXzogRHJhZ0V2ZW50KXtcbiAgICAgICAgY29uc29sZS5sb2coJ0RyYWdFbmQnKVxuICAgIH1cblxuICAgIGNvbmZpZ3VyZSgpe1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdzdGFydFwiLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdlbmRcIiwgdGhpcy5kcmFnRW5kSGFuZGxlcik7XG4gICAgfVxuICAgIFxuICAgIHJlbmRlckNvbnRlbnQoKXtcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMycpIS50ZXh0Q29udGVudCA9IHRoaXMucGVyc29ucyArICcgYXNzaWduZWQnO1xuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XG4gICAgfVxuXG5cbn0iLCJpbXBvcnQge0RyYWdUYXJnZXR9IGZyb20gJy4uL21vZGVscy9kcmFnLWRyb3AnO1xuaW1wb3J0IHtQcm9qZWN0LCBwcm9qZWN0U3RhdHVzfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuL2Jhc2UtY29tcG9uZW50J1xuaW1wb3J0IHsgYXV0b2JpbmQgfSBmcm9tICcuLi9kZWNvcmF0b3JzL2F1dG9iaW5kLWRlY29yYXRvcidcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3Byb2plY3Qtc3RhdGUnXG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gJy4vcHJvamVjdC1pdGVtJ1xuXG5leHBvcnQgY2xhc3MgUHJvamVjdExpc3QgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PiAgaW1wbGVtZW50cyBEcmFnVGFyZ2V0e1xuICAgIGFzc2lnbmVkUHJvamVjdHM6IFByb2plY3RbXTtcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHR5cGU6ICdhY3RpdmUnIHwgJ2ZpbmlzaGVkJyl7XG4gICAgICAgIHN1cGVyKCdwcm9qZWN0LWxpc3QnLCAnYXBwJywgZmFsc2UgLCBgJHt0eXBlfS1wcm9qZWN0c2ApO1xuICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSBbXTtcblxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgICAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcbiAgICB9XG5cbiAgICBAYXV0b2JpbmRcbiAgICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCl7XG4gICAgICAgIGlmIChldmVudC5kYXRhVHJhbnNmZXIgJiYgZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzWzBdID09PSAndGV4dC9wbGFpbicpe1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpITtcbiAgICAgICAgICAgIGxpc3RFbC5jbGFzc0xpc3QuYWRkKCdkcm9wcGFibGUnKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBAYXV0b2JpbmRcbiAgICBkcm9wSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KXtcbiAgICAgICAgY29uc3QgcHJqSWQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoJ3RleHQvcGxhaW4nKTtcbiAgICAgICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KHByaklkLHRoaXMudHlwZSA9PSAnZmluaXNoZWQnID8gcHJvamVjdFN0YXR1cy5GaW5pc2hlZCA6IHByb2plY3RTdGF0dXMuQWN0aXZlKTtcbiAgICB9O1xuXG4gICAgQGF1dG9iaW5kXG4gICAgZHJhZ0xlYXZlSGFuZGxlcihfOiBEcmFnRXZlbnQpe1xuICAgICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XG4gICAgICAgIGxpc3RFbC5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKTtcbiAgICB9O1xuXG4gICAgY29uZmlndXJlKCl7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdsZWF2ZScsIHRoaXMuZHJhZ0xlYXZlSGFuZGxlcik7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5kcm9wSGFuZGxlcik7XG4gICAgICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IFByb2plY3RbXSk9PiB7XG4gICAgICAgICAgICBjb25zdCByZWxldmVudFByb2plY3RzID0gcHJvamVjdHMuZmlsdGVyKHByaj0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50eXBlID09PSAnYWN0aXZlJyl7XG4gICAgICAgICAgICAgICAgICAgcmV0dXJuIHByai5zdGF0dXMgPT09IHByb2plY3RTdGF0dXMuQWN0aXZlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBwcm9qZWN0U3RhdHVzLkZpbmlzaGVkXG5cbiAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgY29uc29sZS5sb2codGhpcyk7XG4gICAgICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSByZWxldmVudFByb2plY3RzO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJQcm9qZWN0cygpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZW5kZXJDb250ZW50KCl7XG4gICAgICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdC1saXN0YDtcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ1bFwiKSEuaWQgPSBsaXN0SWQ7XG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiaDJcIikhLnRleHRDb250ZW50ID0gdGhpcy50eXBlLnRvVXBwZXJDYXNlKCkrICcgUFJPSkVDVFMnXG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0cygpe1xuICAgICAgICBjb25zdCBsaXN0RWwgPSA8SFRNTFVMaXN0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLnR5cGV9LXByb2plY3QtbGlzdGApITtcbiAgICAgICAgbGlzdEVsLmlubmVySFRNTCA9ICcnO1xuICAgICAgICBmb3IgKGNvbnN0IHByakl0ZW0gb2YgdGhpcy5hc3NpZ25lZFByb2plY3RzKXtcbiAgICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCxwcmpJdGVtKTtcbiAgICAgICAgfVxuICAgIH07XG5cbn1cbiIsImltcG9ydCB7UHJvamVjdElucHV0fSBmcm9tICcuL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dCdcbmltcG9ydCB7UHJvamVjdExpc3R9IGZyb20gJy4vY29tcG9uZW50cy9wcm9qZWN0LWxpc3QnXG5cbm5ldyBQcm9qZWN0SW5wdXQoKTtcbm5ldyBQcm9qZWN0TGlzdChcImFjdGl2ZVwiKTtcbm5ldyBQcm9qZWN0TGlzdChcImZpbmlzaGVkXCIpO1xuXG5cblxuIl0sInNvdXJjZVJvb3QiOiIifQ==